install.packages("baseballr")
library(baseballr)
--version
r --version
playerid_lookup("Raleigh", "Cal")
cal <- playerid_lookup("Raleigh", "Cal")$bbref_id
get_chadwick_lu()
cal <- playerid_lookup("Raleigh", "Cal")$bbref_id
library(dplyr)
start25 <- (mlb_seasons() %>% filter(season_id == 2025))$regular_season_start_date
cal_batting <- bref_daily_batter(start25, "2025-09-14") %>%
filter(bbref_id == cal)
str(cal_batting)
bref_id
library(baseballr)
library(dplyr)
cal <- playerid_lookup("Raleigh", "Cal")$bbref_id
library(baseballr)
library(dplyr)
cal <- playerid_lookup("Raleigh", "Cal")$fangraphs_id
start25 <- (mlb_seasons() %>% filter(season_id == 2025))$regular_season_start_date
# pull game-by-game records
cal_batting <- fg_batter_game_logs(cal, 2025)
str(cal_batting)
# pull game-by-game records
cal_batting <- fg_batter_game_logs(cal, 2025) %>% select(Date, Pos, AB:CS)
# split into catcher and DH sets
cal_catcher <- cal_batting %>% filter(Pos == "C")
cal_DH <- cal_batting %>% filter(Pos == "DH")
# calculate statistics for each
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = H / AB,
"OBP" = (H + BB + OBP) / (AB + BB + HBP + SF),
"SLG" = (H + 2*2B + 3*3B + 4*HR) / AB,
cal_batting$2B
# calculate statistics for each
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = H / AB,
"OBP" = (H + BB + OBP) / (AB + BB + HBP + SF),
"SLG" = (H + 2*`2B` + 3*`3B` + 4*HR) / AB,
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = H / AB,
"OBP" = (H + BB + OBP) / (AB + BB + HBP + SF),
"SLG" = (H + 2*`2B` + 3*`3B` + 4*HR) / AB
)
# calculate statistics for each
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = H / AB,
"OBP" = (H + BB + HBP) / (AB + BB + HBP + SF),
"SLG" = (H + 2*`2B` + 3*`3B` + 4*HR) / AB,
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_catcher %>%
summarise(
"BA" = H / AB,
"OBP" = (H + BB + HBP) / (AB + BB + HBP + SF),
"SLG" = (H + 2*`2B` + 3*`3B` + 4*HR) / AB,
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_catcher %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(H) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(H) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_batting %>%
filter(Pos == "C" || Pos == "DH") %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(H) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(H) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# calculate statistics for each
cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(`1B`) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# get Cal's FG lookup
cal <- playerid_lookup("Raleigh", "Cal")$fangraphs_id
# pull game-by-game batting records
cal_batting <- fg_batter_game_logs(cal, 2025) %>% select(Date, Pos, AB:CS)
library(baseballr)
library(dplyr)
# get Cal's FG lookup
cal <- playerid_lookup("Raleigh", "Cal")$fangraphs_id
# pull game-by-game batting records
cal_batting <- fg_batter_game_logs(cal, 2025) %>% select(Date, Pos, AB:CS)
# group by position and calculate statistics
cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(`1B`) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
# get Cal's FG lookup
cal <- playerid_lookup("Raleigh", "Cal")$fangraphs_id
source("C:/Users/patri/Desktop/code/Baseball-Stats/dumper_splits_9-15.R", echo = TRUE)
source("C:/Users/patri/Desktop/code/Baseball-Stats/dumper_splits_9-15.R", echo = TRUE)
tidyr)
# get Cal's FG lookup
cal <- playerid_lookup("Raleigh", "Cal")$fangraphs_id
# pull game-by-game batting records
cal_batting <- fg_batter_game_logs(cal, 2025) %>% select(Date, Pos, AB:CS)
cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(`1B`) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
Hits = sum(H, na.rm = TRUE),
Walks = sum(BB, na.rm = TRUE),
Strikeouts = sum(SO, na.rm = TRUE)
)
# Step 2: reshape data to long format for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "Value")
??pivot_longer
library(tidyr)
?pivot_longer
# Step 2: reshape data to long format for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "Value")
# Step 3: plot
ggplot(cal_long, aes(x = Stat, y = Value, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Batting Stats by Position",
x = "Stat",
y = "Total") +
theme_minimal()
cal_summary <- cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
Hits = sum(H, na.rm = TRUE),
Walks = sum(BB, na.rm = TRUE),
Strikeouts = sum(SO, na.rm = TRUE)
)
# Step 2: reshape data to long format for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "Value")
# Step 3: plot
ggplot(cal_long, aes(x = Stat, y = Value, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Batting Stats by Position",
x = "Stat",
y = "Total") +
theme_minimal()
cal_summary <- cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
Hits = mean(H, na.rm = TRUE),
Walks = mean(BB, na.rm = TRUE),
Strikeouts = mean(SO, na.rm = TRUE)
)
# Step 2: reshape data to long format for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "Value")
# Step 3: plot
ggplot(cal_long, aes(x = Stat, y = Value, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Batting Stats by Position",
x = "Stat",
y = "Total") +
theme_minimal()
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
`1B` = mean(`1B`, na.rm = TRUE),
`2B` = mean(`2B`, na.rm = TRUE),
`3B` = mean(`3B`, na.rm = TRUE),
HR   = mean(HR,  na.rm = TRUE),
BB   = mean(BB,  na.rm = TRUE),
SO   = mean(SO,  na.rm = TRUE),
.groups = "drop"
)
# pull game-by-game batting records
cal_batting <- fg_batter_game_logs(cal, 2025) %>%
select(Date, Pos, AB:CS) %>%
filter(Pos == "C" | Pos == "DH")
# group by position and calculate statistics
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(`1B`) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
`1B` = mean(`1B`, na.rm = TRUE),
`2B` = mean(`2B`, na.rm = TRUE),
`3B` = mean(`3B`, na.rm = TRUE),
HR   = mean(HR,  na.rm = TRUE),
BB   = mean(BB,  na.rm = TRUE),
SO   = mean(SO,  na.rm = TRUE),
.groups = "drop"
)
# Step 3: reshape for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "AvgPerGame")
# Step 4: plot side-by-side bars
ggplot(cal_long, aes(x = Stat, y = AvgPerGame, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Average Per Game by Position",
x = "Stat",
y = "Average per Game") +
theme_minimal()
cal_long
# Step 2: summarise averages per game by position
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
`1B` = mean(`1B`, na.rm = TRUE),
`2B` = mean(X2B, na.rm = TRUE),
`3B` = mean(X3B, na.rm = TRUE),
HR   = mean(HR,  na.rm = TRUE),
BB   = mean(BB,  na.rm = TRUE),
SO   = mean(SO,  na.rm = TRUE),
.groups = "drop"
)
# Step 2: summarise averages per game by position
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
`1B` = mean(`1B`, na.rm = TRUE),
`2B` = mean(`2B`, na.rm = TRUE),
`3B` = mean(`3B`, na.rm = TRUE),
HR   = mean(HR,  na.rm = TRUE),
BB   = mean(BB,  na.rm = TRUE),
SO   = mean(SO,  na.rm = TRUE),
.groups = "drop"
)
# Step 3: pivot wider â†’ long with hit types separated
hits_long <- cal_summary %>%
select(Pos, `1B`, `2B`, `3B`, HR) %>%
pivot_longer(cols = -Pos, names_to = "HitType", values_to = "AvgPerGame") %>%
mutate(Stat = "Hits")
cal_summary
cal_long
hits_long
# Step 4: walks and strikeouts as their own rows
other_stats <- cal_summary %>%
select(Pos, BB, SO) %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "AvgPerGame")
other_stats
# Step 5: combine
plot_data <- bind_rows(
hits_long,
other_stats
)
plot_data
# Step 6: plot
ggplot() +
# stacked bars for Hits
geom_col(data = filter(plot_data, Stat == "Hits"),
aes(x = Stat, y = AvgPerGame, fill = HitType),
position = "stack") +
# side-by-side bars for other stats
geom_col(data = filter(plot_data, Stat %in% c("BB", "SO")),
aes(x = Stat, y = AvgPerGame, fill = Pos),
position = "dodge") +
facet_wrap(~Pos) +  # separate panels for DH vs C
labs(title = "Average Per Game by Position",
x = "Stat",
y = "Average per Game") +
theme_minimal()
cal_summary <- cal_batting %>%
group_by(Pos) %>%
summarise(
`1B` = mean(`1B`, na.rm = TRUE),
`2B` = mean(`2B`, na.rm = TRUE),
`3B` = mean(`3B`, na.rm = TRUE),
HR   = mean(HR,  na.rm = TRUE),
BB   = mean(BB,  na.rm = TRUE),
SO   = mean(SO,  na.rm = TRUE),
.groups = "drop"
)
# Step 3: reshape for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "AvgPerGame")
# Step 4: plot side-by-side bars
ggplot(cal_long, aes(x = Stat, y = AvgPerGame, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Average Per Game by Position",
x = "Stat",
y = "Average per Game") +
theme_minimal()
# pull game-by-game batting records
cal_batting <- fg_batter_game_logs(cal, 2025) %>%
select(Date, Pos, AB:CS) %>%
filter(Pos == "C" | Pos == "DH")
# group by position and calculate statistics
cal_batting %>%
group_by(Pos) %>%
summarise(
"BA" = sum(H) / sum(AB),
"OBP" = (sum(H) + sum(BB) + sum(HBP)) / (sum(AB) + sum(BB) + sum(HBP) + sum(SF)),
"SLG" = (sum(`1B`) + 2*sum(`2B`) + 3*sum(`3B`) + 4*sum(HR)) / sum(AB),
"OPS" = OBP + SLG
)
cal_summary <- cal_batting %>%
filter(Pos == "C" | Pos == "DH") %>%
group_by(Pos) %>%
summarise(
Hits = mean(H, na.rm = TRUE),
Walks = mean(BB, na.rm = TRUE),
Strikeouts = mean(SO, na.rm = TRUE)
)
# Step 2: reshape data to long format for ggplot
cal_long <- cal_summary %>%
pivot_longer(cols = -Pos, names_to = "Stat", values_to = "Value")
# Step 3: plot
ggplot(cal_long, aes(x = Stat, y = Value, fill = Pos)) +
geom_col(position = "dodge") +
labs(title = "Batting Stats by Position",
x = "Stat",
y = "Total") +
theme_minimal()
